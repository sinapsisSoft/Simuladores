<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script type="text/javascript">
	
	
	
	
	function createTableAmortization(idTable,term,rate,rode){
		
		rate=rate/100;
		var tazaAnual=rate*12;
		var balances=[3];
		var previousBalance=rode;
		$("#"+idTable+" >thead").remove();
		$("#"+idTable+" >tbody").remove();
		$("#"+idTable+" >tfoot").remove();
		var table=$("#"+idTable);
		table+="<thead><tr><th>Per√≠odos</th><th>Cuota</th><th>Interes</th><th>Abono K</th><th>Saldo</th></tr></thead><tbody>";
		var operation=(Math.pow((1+rate),term)*rate)/((Math.pow((1+rate),term)-1));
		var ressult=rode*(operation);
		for(var i=1;i<=term;i++){
			table+="<tr>";
		var interest=previousBalance*rate;
		var deposit=ressult-interest;
		previousBalance=previousBalance-deposit;
		/*console.log("Periodo :"+i);
		console.log("Cuota :"+ressult);
		console.log("Interes :"+interes);
		console.log("Abono :"+abono);*/
			if(previousBalance<1){
				previousBalance=0;
			}
		//console.log("Saldo :"+saldoAnterior);
		
		table+="<td>"+i+"</td>"+"<td> $"+numberWithCommas(ressult.toFixed(0))+"</td>"+"<td> $"+numberWithCommas(interest.toFixed(0))+"</td>"+"<td> $"+numberWithCommas(deposit.toFixed(0))+"</td>"+"<td> $"+numberWithCommas(previousBalance.toFixed(0))+"</td>";

			if(i==1){
			balances[0]=ressult;
			balances[1]=interest;
			balances[2]=deposit;
				
				}
			else{
				
			balances[0]=ressult+balances[0];
			balances[1]=interest+balances[1];
			balances[2]=deposit+balances[2];
			}
		
		table+="</tr></tbody>";	
		}
		
		table+="<tfoot><tr><td>Totales</td><td>$"+numberWithCommas(balances[0].toFixed(0))+"</td><td> $"+numberWithCommas(balances[1].toFixed(0))+"</td><td> $"+numberWithCommas(balances[2].toFixed(0))+"</td></tr></tfoot>";
	
		
		$("#tableResult").append(table);
	}
	function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}
	
</script>
</head>

<body>
<input type="button"  onClick="createTableAmortization('tableResult',5,1.5,300000)" value="load table"/>
<div id="containerTable">
	<table id='tableResult'></table>
</div>
</body>
</html>
